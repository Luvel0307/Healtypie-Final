"use strict";(()=>{var e={};e.id=998,e.ids=[998],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2808:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>j,patchFetch:()=>y,requestAsyncStorage:()=>v,routeModule:()=>f,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x});var a={};t.r(a),t.d(a,{POST:()=>g,dynamic:()=>m});var o=t(9182),n=t(2007),i=t(6719),s=t(3442);let p=require("@aws-sdk/client-s3"),u=new p.S3Client({}),{bucketName:c,folderPrefix:d}={bucketName:process.env.AWS_BUCKET_NAME,folderPrefix:process.env.AWS_FOLDER_PREFIX||""};async function l(e,r){let t=`${d}uploads/${Date.now()}-${r}`,a=new p.PutObjectCommand({Bucket:c,Key:t,Body:e,ContentType:function(e){switch(e.toLowerCase().split(".").pop()){case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"gif":return"image/gif";case"bmp":return"image/bmp";default:return"application/octet-stream"}}(r)});return await u.send(a),t}let m="force-dynamic";async function g(e){try{let r=(await e.formData()).get("file");if(!r)return s.NextResponse.json({error:"No se proporcion\xf3 archivo"},{status:400});if(!["image/jpeg","image/jpg","image/png","image/bmp"].includes(r.type))return s.NextResponse.json({error:"Tipo de archivo no v\xe1lido. Solo se permiten im\xe1genes JPG, PNG, BMP"},{status:400});if(r.size>10485760)return s.NextResponse.json({error:"El archivo es demasiado grande. M\xe1ximo 10MB"},{status:400});let t=Buffer.from(await r.arrayBuffer()),a=await l(t,r.name);return s.NextResponse.json({success:!0,cloudStoragePath:a,fileName:r.name,fileSize:r.size,contentType:r.type})}catch(e){return console.error("Error uploading file:",e),s.NextResponse.json({error:"Error al subir archivo"},{status:500})}}let f=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/upload/route",pathname:"/api/upload",filename:"route",bundlePath:"app/api/upload/route"},resolvedPagePath:"/home/ubuntu/sistema_pie_diabetico/app/app/api/upload/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:v,staticGenerationAsyncStorage:x,serverHooks:h}=f,j="/api/upload/route";function y(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[372,609],()=>t(2808));module.exports=a})();