"use strict";(()=>{var e={};e.id=618,e.ids=[618],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2106:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{GET:()=>p,POST:()=>d,dynamic:()=>u});var a=t(9182),i=t(2007),s=t(6719),o=t(3442),c=t(5970);let u="force-dynamic";async function p(e){try{let{searchParams:r}=new URL(e.url),t=r.get("search"),n=(t?await c._.paciente.findMany({where:{nombre:{contains:t,mode:"insensitive"}},include:{evaluaciones:{orderBy:{fechaHora:"desc"},take:1}},orderBy:{fechaActualizacion:"desc"}}):await c._.paciente.findMany({include:{evaluaciones:{orderBy:{fechaHora:"desc"},take:1}},orderBy:{fechaActualizacion:"desc"},take:50})).map(e=>({...e,evaluaciones:e.evaluaciones.map(e=>({...e,riesgo:Number(e.riesgo),areaLesion:Number(e.areaLesion),desvEstR:Number(e.desvEstR),mediaR:Number(e.mediaR),mediaG:Number(e.mediaG),mediaB:Number(e.mediaB)}))}));return o.NextResponse.json({pacientes:n})}catch(e){return console.error("Error fetching patients:",e),o.NextResponse.json({error:"Error interno del servidor"},{status:500})}}async function d(e){try{let{nombre:r}=await e.json();if(!r||0===r.trim().length)return o.NextResponse.json({error:"El nombre del paciente es requerido"},{status:400});if(await c._.paciente.findFirst({where:{nombre:r.trim()}}))return o.NextResponse.json({error:"Ya existe un paciente con ese nombre"},{status:400});let t=await c._.paciente.create({data:{nombre:r.trim()}});return o.NextResponse.json({success:!0,paciente:t})}catch(e){return console.error("Error creating patient:",e),o.NextResponse.json({error:"Error interno del servidor"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/pacientes/route",pathname:"/api/pacientes",filename:"route",bundlePath:"app/api/pacientes/route"},resolvedPagePath:"/home/ubuntu/sistema_pie_diabetico/app/app/api/pacientes/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:v}=l,f="/api/pacientes/route";function g(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}},5970:(e,r,t)=>{t.d(r,{_:()=>i});let n=require("@prisma/client");class a{getClient(){return this.client||(this.client=new n.PrismaClient({log:["error"]})),this.client}constructor(){this.client=null}}let i=new a().getClient()}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[372,609],()=>t(2106));module.exports=n})();